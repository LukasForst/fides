\section{Network Intelligence Aggregation}
\label{sec:network-intelligence-aggregation}
Fides is a trust model designed for global peer-to-peer network that is created by instances of Slips.
It is designed to support Slips in detecting malicious actors on the network and enables threat intelligence sharing between peers of Slips instances.
Because Slips was designed to be as modular as possible, Fides is effectively running as a module which provides aggregated threat intelligence to Slips. 
In other words, Fides provides a view on what does the network think about some threat intelligence target.
This means that Fides needs to be able to aggregate elements of threat intelligence from remote peers into a single value that is then presented to Slips - ($S^{k}_{T}$, $C^{k}_{T}$) - a network opinion on given target $T$ in window $k$.

We need to be able to say, that some reports are better then others based on the service trust the local peer has in remote peer - $st^{k}_{i, j}$.
Thus we need to weight every report based on this trust.
Let $R^{k}_{i, T}$ denote a set of remote peers that provided threat intelligence ($S^{k}_{j, T}$, $C^{k}_{j, T}$) to a local peer $i$ and $ws^{k}_{j}$ weight of their report (computed by $i$ as a normalized service trust that it has in the remote peer).
Then we can compute aggregated score $S^{k}_{T}$ like.
\begin{equation}
\begin{split}
    ws^{k}_{j} &= \frac{1}{\sum_{{j}\in R^{k}_{i, T}} st^{k}_{i, j}} \cdot st^{k}_{i, j} \\
    S^{k}_{T} &= \sum_{{j}\in R^{k}_{i, T}} ws^{k}_{j} \cdot S^{k}_{j, T}
\end{split}
\end{equation}

We also need to compute aggregated confidence $C^{k}_{T}$ that expresses how confident we are about the $S^{k}_{T}$ that was computed in the previous step.
Again, we use service trust to compute this for each remote peer and normalize it. 
\begin{equation}
\begin{split}
    C^{k}_{T} &= \frac{1}{|R^{k}_{i, T}|} \cdot \sum_{{j}\in R^{k}_{T}} st^{k}_{i, j} \cdot C^{k}_{j, T}
\end{split}
\end{equation}

\noindent 
Aggregated score and confidence ($S^{k}_{T}$, $C^{k}_{T}$) is then sent to Slips.
Depending on the selected interaction evaluation strategy (described in \ref{sec:interaction-evaluation-strategies}), these values can be further used to evaluate each interaction with the remote peers.