\section{Network Intelligence Aggregation}
\label{sec:network-intelligence-aggregation}
Fides is a trust model designed for global peer-to-peer networks of Slips instances.
It is designed to support Slips in detecting malicious actors on the network and enables threat intelligence sharing between peers of Slips instances.
Because Slips was designed to be as modular as possible, Fides is effectively running as a module that provides aggregated threat intelligence to Slips. 
In other words, Fides provides a view of what the network thinks about some threat intelligence target. This is necessary so Slips can have a unique \textit{view} of the network on a specific Threat Intelligence.
Fides needs to aggregate elements of threat intelligence from remote peers into a single value that is then presented to Slips.

%- ($S^{k}_{T}$, $C^{k}_{T}$) - a network opinion on given target $T$ in window $k$.

% We need to be able to say,

Fides needs to say that some reports are better than others, based on the service trust the local peer has in the remote peer (previously computed as $st^{k}_{i, j}$).
Thus Fides need to weigh every report based on this trust and to come up with an aggregated score $S^{k}_{T}$:

\begin{equation}
\begin{split}
    S^{k}_{T} &= \sum_{{j}\in R^{k}_{i, T}} wst^{k}_{i, j} \cdot S^{k}_{j, T}
\end{split}
\end{equation}

The aggregated score $S^{k}_{T}$ is the sum of $S^{k}_{j, T}$, which is the score sent by each peer $j$ about target $T$ in time window $k$; weighed with the normalized service trust that $i$ computed for peer $j$, denoted $wst^{k}_{i, j}$. The sum is done over the set of remote peers that provided a report to $i$ for $T$ in time window $k$, denoted $R^{k}_{i, T}$.

The normalized service trust used as weight is computed as:

\begin{equation}
\begin{split}
    wst^{k}_{i,j} &= \frac{1}{\sum_{{j}\in R^{k}_{i, T}} st^{k}_{i, j}} \cdot st^{k}_{i, j} \\
\end{split}
\end{equation}

Which estimates the percentage that the service trust on $j$ $st^{k}_{i, j}$ has relative to the total sum of service trust received by $i$ for all peers, for this target $T$, on time window $k$.

Apart from the aggregated score, Fides needs to compute the aggregated confidence $C^{k}_{T}$ that expresses how confident $i$ is about the aggregated score $S^{k}_{T}$ that was computed in the previous step. The aggregated confidence is:

\begin{equation}
\begin{split}
    C^{k}_{T} &= \frac{1}{|R^{k}_{i, T}|} \cdot \sum_{{j}\in R^{k}_{i, T}} st^{k}_{i, j} \cdot C^{k}_{j, T}
\end{split}
\end{equation}

Which is an average, over all the peers that sent to $i$ a report on $T$ in time window $k$, of the weighted confidence sent by peer $j$ on target $T$ on time window $k$. The weight is done by the service trust that $i$ has on $j$ on time window $k$.


The aggregated score and confidence ($S^{k}_{T}$, $C^{k}_{T}$) are then sent to Slips about the report on target $T$.

Apart from sending to Slips, these same values can be used to evaluate the interaction the the remote peers, depending on the selected interaction evaluation strategy (described in \ref{sec:interaction-evaluation-strategies}).