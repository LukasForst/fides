\chapter{Trust Model Design}
\label{ch:trust-model-design}
The goal of this thesis is to design and implement a trust model for sharing threat intelligence in global peer-to-peer networks where the peers are instances of intrusion prevention systems.
In the previous chapter, we outlined what is the threat intelligence, how it is generated, and why are trust relationships important when making decisions based on the said threat intelligence.
We described what are the trust models in the context of peer-to-peer networks and analyzed the notable ones.
We discovered the promising trust model SORT~\cite{sort} which we described in section \ref{subsec:sort} and after careful analysis, we decided to use SORT's algorithm as a base for our own trust model design mainly because of its flexibility and modularity.

In this chapter, we propose a new trust model - \textbf{Fides} - that utilizes modified SORT's computational model with multiple modifications and extensions that allow it to effectively work in highly adversarial global peer-to-peer networks.
Fides is a generic and heavily configurable trust model that specializes in sharing threat intelligence.
Its design allows it to operate with any kind of data and it is not limited to only threat intelligence. 
Thanks to its modular architecture, it is able to operate with any kind of data with very few modifications to its implementation

In the section~\ref{sec:general-overview-of-fides} we describe our trust model design and explain how Fides works on a high level, what are the inputs and outputs and how does it behave in which situation.

After outlining the general overview, we analyze weaknesses of the trust models in general and how do they apply on Fides.
First, we start with \textit{cold start problem} in the section~\ref{sec:cold-start-problem} which describe how can peers gain trust when they are new in the network and how does Fides tackle this issue.

In the next section~\ref{sec:attack-vectors} we analyze possible attack vectors on our trust model and then we dig deep into the taxonomy of attacks in the next section~\ref{sec:taxonomy-of-attacks}.

Once all trust model requirements are explained we dive deep into the Fides's computational model in the next section~\ref{sec:computational-model}  and explain how it is able to uncover trust relationships in the network.
In the following section \ref{sec:interaction-evaluation-strategies}, we explain how is Fides able to evaluate interactions between peers and how that affects trust.
Because Fides specializes in sharing threat intelligence and integrates with Slips, in the next section \ref{sec:network-intelligence-aggregation} we explain how Fides aggregates the weighted threat intelligence from the network.

\vspace{1cm}

\noindent
In the upcoming pages, we use the following terminology when we talk about the trust model.

\begin{itemize}

\item \textbf{Target}: An identification of a resource that Slips has the capability to generate threat intelligence for. It can be for example either an IP address, domain or hashes.

\item \textbf{Local Peer}: The unique local instance of Slips that are connected to the global P2P network and runs Fides. In equations, we use $i$ when referring to the local peer.

\item \textbf{Remote Peer}. A peer that is on the Internet and is connected to the global Slips P2P2 network. In equations, we use $j$ when referring to the remote peer.

\item \textbf{Service Trust}: How much does Fides trust a remote peer that it provides the local peer with good service. In other words, to what extent does Fides trust a specific peer that it provides correct and useful threat intelligence. We denote it $st$ and talk about it in detail in section~\ref{subsec:service-trust}.

\end{itemize}

\include{chapters/chap3-trust-model-design/general_overview}

\include{chapters/chap3-trust-model-design/cold_start}

\include{chapters/chap3-trust-model-design/attack_vectors}

\include{chapters/chap3-trust-model-design/computational_model}

\include{chapters/chap3-trust-model-design/interaction_evaluation}

\include{chapters/chap3-trust-model-design/ti_aggregation}