\chapter{Introduction}
\label{ch:introduction}

% Structure of this chapter

% The why, the problem being solved
% What others did before
% The gap, what was missing
% Your proposal
% Your results
% Discussion on results/conclusions
% Your contributions

When protecting the local networks, the basic firewalls and advanced Intrusion Prevention Systems (IPS)~\cite{zhang2004intrusion} rely on rules and the threat intelligence~\cite{threatintelligence} generated from the previous attacks locally or received from the remote sources.
Such sources can be, for example, public blocklists ~\cite{abuseipdb, binarydefense, dataplane} or collaborative databases such as MISP~\cite{wagner2016misp} where the community creates the threat intelligence.
However, all of these traditional threat intelligence sources are, in the end, controlled by the centralized authority, which has complete control over the resource and can at anytime restrict access to these valuable assets or censor what is published and what is not.

To limit the impact of one organization shutting down the database, we can utilize the peer-to-peer model and remove the central authority and a single point of failure.
In the peer-to-peer networks, each peer has the same privileges, and the data are generated, shared, and consumed by each peer in the network.
Although this approach solves the problem of a single central authority, it introduces new problems. The crucial question is how much can each peer trust the threat intelligence that it received from other peers? And also, what if two peers provide contradicting information? How can a peer aggregate two opinions into a single decision?

In this thesis, we answer those questions and tackle the problem of trust relationships when sharing threat intelligence.
The algorithms that tackle trust relationships between multiple entities are called \textit{trust models}~\cite{wang2003trust}.
The research field of trust models is not new, and there are many existing trust models~\cite{kamvar2003eigentrust, xiong2004peertrust, 1562680, huynh2006integrated, sort, pinyol2013computational, christensen2014hybrid,li2014design, abera2019sadan}.
However, they were primarily designed to support file sharing in peer-to-peer networks and inherently operate with different kinds of data.
An exemption to them is the Dovecot~\cite{dita}, which was designed to operate with the threat intelligence with a limitation to operate only in the local networks.

In this thesis, we go a step further and propose a new trust model \textbf{Fides}.
Fides is a generic trust model fine-tuned for sharing threat intelligence in highly adversarial global peer-to-peer networks of intrusion prevention agents.
We build Fides with the lessons learned from other trust models~\cite{sort, dita} and optimize it for the broad spectrum of networks starting with local networks controlled by a single company to the public global peer-to-peer networks where anybody can join and leave at any time.

Furthermore, Fides can identify the peers that belong to organizations and allows its administrator to pre-trust specific peers and organizations. The comprehensive configuration options enable administrators to configure data sharing only inside or with particular organizations. This data filtering guarantees that no privacy-sensitive intelligence is shared with peers that should not have access to it.

Moreover, Fides was designed to be as modular and generic as possible, allowing other utilization of its computational model for different data than the threat intelligence by simply adding new evaluation methods.

Fides does not create the peer-to-peer network by itself but instead uses a different system that performs the operations on the network layer.
Communication between these two systems is done via the standard defined interface, which allows replacing the network module if needed.
An implementation of such a network layer is the \textbf{Iris}. Iris was designed and developed simultaneously by Bc. Martin Å˜epa~\cite{nl} and it facilitates safe and secure communication between the Fides instances in the global peer-to-peer network.

In our implementation, we chose Stratosphere Linux IPS (Slips)~\cite{slips} as the example of the intrusion prevention system and implemented a module that allows Slips to use Fides for receiving and sharing threat intelligence over the network. 
By utilizing this shared global knowledge, Slips can prevent attacks on the local environment even before they happen by acting upon received threat intelligence from other peers in the global network.

While evaluating the trust model, we simulated complex simulations. We proved that Fides could correctly uncover the peers' behavior in the network and make sensible decisions about the threat intelligence. 
Fides especially excels in the situations when it communicates with peers from trusted organizations.
Moreover, in a situation where the Fides talks to at least 25\% of pre-trusted peers, it can eventually determine correct threat intelligence no matter how other peers in the network behave and how many of them are adversarial.

% structure of the thesis
This thesis explains the required background and describes the current state of the art in the chapter~\ref{ch:previous-work-background}.
In the next chapter~\ref{ch:trust-model-design} we propose a new trust model Fides and then outline how it works from the high-level perspective in the section~\ref{sec:general-overview-of-fides}.
After that, we explain problems related to gaining trust in the section~\ref{sec:cold-start-problem}.
In the following sections~\ref{sec:attack-vectors}~and~\ref{sec:taxonomy-of-attacks} we analyze the taxonomy of attacks and the attack vectors related explicitly to the trust models and discuss how Fides defends against them.
Once we explain our design choices, we describe the whole computational model in depth in section~\ref{sec:computational-model} and illustrate how Fides can determine trust relationships in the network by evaluating interactions between peers in the section~\ref{sec:interaction-evaluation-strategies}.
The last part of the computational model in the section~\ref{sec:network-intelligence-aggregation} explains how Fides can aggregate threat intelligence from the network.
The chapter~\ref{ch:architecture} then describes the Fides's architecture and how we implemented it as a new Slips module.
In the following chapter~\ref{ch:experiments} we propose simulations that evaluate the performance of the trust model and give a brief overview of the simulation framework that we developed alongside Fides.
Chapter~\ref{ch:results} then describes the results that we discovered in the evaluations. The last chapter~\ref{ch:conclusion} conclude our results and proposes further areas of improvement for the Fides. 
We also include an appendix with multiple interesting cases of evaluations discovered in the chapter~\ref{ch:results}.